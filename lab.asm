%TITLE "Lab1"
    ;???????: ?????????? ??????????? ?????????, 
    ;??????????? ???????? ?????????, 
    ;??????? ????????? ?? ???? ??? ????????? ?????????? ????? A,B,C, 
    ;??????????? ? ????????? ?? -128 ?? 127. 
    ;??? ?????? ?????, ??? ??????? ?????????? ????????????, 
    ;?????????? ??????? ? ????. ? ????????? ???????????? 16-????????? ????????.
    
    ;--------------------------------------
    ; d = (a + 12*b*c+6) / (65*c+7*a^2)
    ;--------------------------------------
    
.model small
.stack 100h

.data
    ; ?? -128 ?? 127 <=> 80h to 7Fh
    message db 'hi = hey', '$'
    path db 'D:\NEWFILE.TXT', 0
    a db 0
    b db 127
    c db 12
    d db ?
    handle dw ?
    buffer db 8 dup (?)
    
.code 
Start:
    mov ax, @data
    mov ds, ax
    xor ax, ax

;check if undefined 
    mov cx, 6
    repe scasb
    ;jne calc
    
mkFile:
    mov dx, offset path
    mov ah, 03Ch
    xor cx, cx
    int 21h
    mov [handle], ax

if_undefined:
    
wrFile:
        mov [buffer], 041h
        mov [buffer+1], 00h
        mov [buffer+2], 3dh
        mov al, a
        aam
        or ax, 0030h
        mov [buffer+3], 00h
        mov [buffer+6], al
        mov al, ah
        aam
        or ax, 3030h
        mov [buffer+5], al
        mov [buffer+4], ah
        mov [buffer+7], 0ah
        mov [buufer
        mov dx, offset buffer
        mov cx, 8
    mov ah, 40h
    mov bx, handle
    int 21h
    cmp [a], 120
    jz clFile
    inc [a]
    jmp wrFile
    
clFile:
    mov ah, 3Eh
    mov bx, [handle]
    int 21h
    
Exit:
    mov ah, 04Ch
    mov al, 0
    int 21h

    End Start
    
